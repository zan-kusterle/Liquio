<style>
	.area {
		width: 120px;
		height: 45px;
		position: relative;
	}

	.bubble {
		position: absolute;
		left: 0px;
		top: 0px;
		width: 120px;
		height: 45px;
		display: table;
	}

	.bubble p {
		display: table-cell;
		vertical-align: middle;
		text-align: center;
		font-weight: bold;
		color: #333;
		font-size: 16px;
		line-height: 14px;
	}
</style>

<div class="area" style="background: <%= results_color(@poll) %>;">
	<div class="bubble">
		<%= if @poll.choice_type == "time_quantity" do %>
			<%= if Enum.empty?(@poll.results.by_datetime) do %>
				<p>?</p>
			<% else %>
				<%= render "chart.html", points: @poll.results.by_datetime |> Enum.map(& {&1.datetime, &1.points, &1.turnout_ratio}), tooltips: false %>
			<% end %>
		<% else %>
			<p>
				<% mean = if @poll.results != nil and Map.has_key?(@poll.results.by_keys, "main") do @poll.results.by_keys["main"].mean else nil end %>
				<%= if mean != nil do %>
					<%= if @poll.choice_type == "probability" do %>
						<%= round(mean * 100) %>%
					<% else %>
						<%= number_format(mean) %>
					<% end %>
				<% else %>
					?
				<% end %>
			</p>
		<% end %>
	</div>
</div>
